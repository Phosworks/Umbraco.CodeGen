<style type="text/css">

    .codegenconfig legend button {
        float: right;
    }

</style>

<div ng-controller="codegen.configuration.controller" class="codegenconfig">
    
    <form autocomplete="off">
        <fieldset>
            <legend>
                <button class="btn btn-success" ng-click="save()">Save</button>
                CodeGen Configuration
            </legend>
            

            <div class="row-fluid">

                <div class="span2">
                    <label>
                        Generator:
                    </label>
                </div>
                <div class="span10">
                    <div class="btn-group">
                        <button type="button" class="btn btn-default">{{config.GeneratorFactory}}</button>
                        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu">
                            <li ng-repeat="factory in factories" ng-class="$index % 2 == 0 ? 'table-striped' : ''" ng-click="setFactory(factory)">
                                <a href="#">
                                    <div class="row-fluid">
                                        <div class="span1">Generator:</div>
                                        <div class="span2">{{factory.GeneratorFactory}}</div>
                                    </div>
                                    <div class="row-fluid">
                                        <div class="span1">Parser:</div>
                                        <div class="span2">{{factory.ParserFactory}}</div>
                                    </div>
                                    <div class="row-fluid">
                                        <div class="span3">{{factory.Description}}</div>
                                    </div>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>

            </div>
            
            <div class="row-fluid">
                <div class="span2">
                    <label>Source control:</label>
                </div>
                <div class="span10">
                    <label>
                        <input type="checkbox" ng-model="config.OverwriteReadOnly"/>
                        Overwrite read-only files
                    </label>
                </div>
            </div>

        </fieldset>

        <fieldset ng-repeat="contentType in contentTypes">
            <legend>{{contentType.name}}</legend>
            <div ng-include="contentTypeTemplate"></div>
        </fieldset>
        
        <fieldset>
            <legend>Type mappings</legend>
            <div class="row-fluid">
                <div class="span2">
                    <label>Default type:</label>
                </div>
                <div class="span10">
                    <input type="text" class="input-block-level" ng-model="config.TypeMappings.DefaultType" codegen-typeahead="propose" />
                </div>
            </div>
            <div class="row-fluid">
                <div class="span2">
                    <label>Default definition:</label>
                </div>
                <div class="span10">
                    <input type="text" class="input-block-level" ng-model="config.TypeMappings.DefaultDefinitionId" />
                </div>
            </div>
            <table class="table table-striped">
                <tr>
                    <th>Data type</th>
                    <th>Type</th>
                    <th>Description</th>
                    <th></th>
                </tr>
                <tr ng-repeat="typeMapping in config.TypeMappings.Items">
                    <td>
                        <div class="input-append btn-group">
                            <input type="text" class="input-large" ng-model="typeMapping.DataTypeId" ng-change="evaluateDataTypes()" />
                            <button class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                <li ng-repeat="dataType in validDataTypes" ng-click="setDataType(typeMapping, dataType)"><a href="#">{{dataType.alias}}</a></li>
                            </ul>
                        </div>
                    </td>
                    <td>
                        <input type="text" class="input-block-level" ng-model="typeMapping.Type" codegen-typeahead="propose" />
                    </td>
                    <td><input type="text" class="input-block-level" ng-model="typeMapping.Description" /></td>
                    <td><button class="btn btn-danger btn-small" ng-click="removeDataType($index)"><span class="icon-remove-circle icon-white"></span></button></td>
                </tr>
                <tr>
                    <td>
                        <div class="input-append btn-group">
                            <input type="text" class="input-large" ng-model="newTypeMapping.DataTypeId" ng-change="evaluateDataTypes()" />
                            <button class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                <li ng-repeat="dataType in validDataTypes" ng-click="setDataType(newTypeMapping, dataType)"><a href="#">{{dataType.alias}}</a></li>
                            </ul>
                        </div>
                    </td>
                    <td>
                        <input type="text" class="input-block-level" ng-model="newTypeMapping.Type" codegen-typeahead="propose" />
                    </td>
                    <td><input type="text" class="input-block-level" ng-model="newTypeMapping.Description" /></td>
                    <td><button class="btn btn-success btn-small" ng-click="addDataType()"><span class="icon-ok-circle icon-white"></span></button></td>
                </tr>
            </table>
        </fieldset>

    </form>

</div>